# EGG

###### 863p

>게임을 하는데 캐릭터가 죽어버렸다
>
>어서 빨리 살려서 다시 게임을 하자
>
>hint : xor
>
>[Link](https://drive.google.com/uc?export=download&id=1fyapi8Y_YLIFlQLlXC35ajZOopv4R3sq)

------

64bit ELF 바이너리를 준다.

DWARF정보가 포함되어있어서 함수명이 그대로 보인다.

ch함수로 플래그값을 입력받아서 검증받는데 입력받은 플래그에 sha함수로 통해서 나온 값을 xor한다.

그래서 sha함수를 시뮬레이팅 할수 만 있으면 다시 xor해주면 된다.

다음과 같은소스를 짜서 해결했다.

```python
tab=[0x8,0x9,0xF,0x5,0xB,0x1,0x3,0x5,
     0xD,0x1,0xE,0x3,0x4,0xE,0x7,0x4,
     0xC1,0x6,0x6,0xC,0xF,0xA,0xC,0xA,
     0x2,0xD,0x8,0x7,0x3,0x7,0x1,0x7,
     0x5,0x8,0xC,0x3,0x4,0xB,0xE,0x5,
     0x1,0xB,0x0,0x3,0x9,0x4,0x5,0x0,
     0x6,0x8,0xC,0x5,0x3,0xA,0xF,0x3,
     0xE,0xF,0x4,0x8,0xA,0xB,0xF,0x2]
dest="Mh;y;mR1@OijQhHW6Ah=hB"

flag=""
for i in range(len(dest)):
    flag+=chr(ord(dest[i])^tab[((i + 2)^0x11)])
print(flag)
```

--------

FLAG는 `FLAG{An1v1a_3GGniViA_3Ni6mA}`이다.